<Window x:Class="BiometricStudentPickup.Views.StudentManagementWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="ðŸ“š Student Management"
        Height="700"
        Width="1000"
        WindowStartupLocation="CenterOwner"
        Background="{DynamicResource MaterialDesignPaper}"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        FontFamily="Segoe UI">

    <Window.Resources>
        <Style x:Key="HeaderTextStyle"
               TargetType="TextBlock">
            <Setter Property="FontSize"
                    Value="18"/>
            <Setter Property="FontWeight"
                    Value="SemiBold"/>
            <Setter Property="Foreground"
                    Value="{DynamicResource PrimaryHueMidBrush}"/>
            <Setter Property="VerticalAlignment"
                    Value="Center"/>
        </Style>

        <Style x:Key="ActionButtonStyle"
               TargetType="Button">
            <Setter Property="Height"
                    Value="32"/>
            <Setter Property="MinWidth"
                    Value="80"/>
            <Setter Property="Margin"
                    Value="4,0"/>
            <Setter Property="Padding"
                    Value="12,2"/>
            <Setter Property="FontSize"
                    Value="13"/>
            <Setter Property="Cursor"
                    Value="Hand"/>
        </Style>

        <Style x:Key="PrimaryButtonStyle"
               BasedOn="{StaticResource ActionButtonStyle}"
               TargetType="Button">
            <Setter Property="Background"
                    Value="{DynamicResource PrimaryHueMidBrush}"/>
            <Setter Property="Foreground"
                    Value="White"/>
        </Style>

        <Style x:Key="SecondaryButtonStyle"
               BasedOn="{StaticResource ActionButtonStyle}"
               TargetType="Button">
            <Setter Property="Background"
                    Value="{DynamicResource MaterialDesignCardBackground}"/>
            <Setter Property="BorderBrush"
                    Value="{DynamicResource MaterialDesignDivider}"/>
            <Setter Property="BorderThickness"
                    Value="1"/>
        </Style>

        <Style x:Key="DangerButtonStyle"
               BasedOn="{StaticResource ActionButtonStyle}"
               TargetType="Button">
            <Setter Property="Background"
                    Value="#DC3545"/>
            <Setter Property="Foreground"
                    Value="White"/>
        </Style>
    </Window.Resources>

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="10"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header Section -->
        <Border Grid.Row="0"
                Background="{DynamicResource PrimaryHueLightBrush}"
                CornerRadius="8"
                Padding="20,16"
                Margin="0,0,0,12">
            <StackPanel Orientation="Horizontal">
                <materialDesign:PackIcon Kind="AccountSchool"
                                         Width="32"
                                         Height="32"
                                         Foreground="{DynamicResource PrimaryHueMidBrush}"
                                         Margin="0,0,16,0"/>
                <StackPanel>
                    <TextBlock Text="Student Management"
                               FontSize="24"
                               FontWeight="Bold"
                               Foreground="{DynamicResource PrimaryHueMidBrush}"/>
                    <TextBlock Text="Manage student records, classes, and guardian associations"
                               FontSize="14"
                               Foreground="{DynamicResource MaterialDesignBody}"
                               Margin="0,4,0,0"/>
                </StackPanel>
            </StackPanel>
        </Border>

        <!-- Search and Controls Section -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Search Box -->
            <materialDesign:Card Grid.Column="0"
                                 Padding="8"
                                 Margin="0,0,16,0">
                <Grid>
                    <materialDesign:PackIcon Kind="Magnify"
                                             Width="20"
                                             Height="20"
                                             Foreground="{DynamicResource MaterialDesignBody}"
                                             VerticalAlignment="Center"
                                             Margin="12,0,0,0"/>
                    <TextBox x:Name="SearchBox"
                             BorderThickness="0"
                             Background="Transparent"
                             Padding="40,8,8,8"
                             VerticalAlignment="Center"
                             materialDesign:HintAssist.Hint="Search students by name, class, or guardian..."
                             FontSize="14"
                             TextChanged="SearchBox_TextChanged"/>
                </Grid>
            </materialDesign:Card>

            <!-- Action Buttons -->
            <StackPanel Grid.Column="1"
                        Orientation="Horizontal"
                        HorizontalAlignment="Right">
                <Button Content="âž• Add Student"
                        Style="{StaticResource PrimaryButtonStyle}"
                        Click="AddStudent_Click"
                        ToolTip="Add new student"/>

                <Button Content="ðŸ”„ Refresh"
                        Style="{StaticResource SecondaryButtonStyle}"
                        Click="Refresh_Click"
                        ToolTip="Refresh student list"
                        Margin="8,0,0,0"/>

                <Button Content="ðŸ“‹ Export"
                        Style="{StaticResource SecondaryButtonStyle}"
                        Click="Export_Click"
                        ToolTip="Export student data to CSV"
                        Margin="8,0,0,0"/>
            </StackPanel>
        </Grid>

        <!-- Students Table -->
        <materialDesign:Card Grid.Row="3"
                             Padding="0"
                             Margin="0,12,0,0">
            <DataGrid x:Name="StudentsGrid"
                      AutoGenerateColumns="False"
                      IsReadOnly="True"
                      CanUserAddRows="False"
                      CanUserDeleteRows="False"
                      CanUserReorderColumns="False"
                      CanUserSortColumns="True"
                      RowHeight="48"
                      GridLinesVisibility="None"
                      HeadersVisibility="Column"
                      SelectionMode="Single"
                      SelectionUnit="FullRow"
                      BorderThickness="0"
                      Background="Transparent">

                <DataGrid.Resources>
                    <Style TargetType="DataGridColumnHeader">
                        <Setter Property="Background"
                                Value="{DynamicResource PrimaryHueLightBrush}"/>
                        <Setter Property="Foreground"
                                Value="{DynamicResource PrimaryHueMidForegroundBrush}"/>
                        <Setter Property="FontWeight"
                                Value="SemiBold"/>
                        <Setter Property="Padding"
                                Value="12,8"/>
                        <Setter Property="BorderThickness"
                                Value="0,0,0,2"/>
                        <Setter Property="BorderBrush"
                                Value="{DynamicResource PrimaryHueMidBrush}"/>
                    </Style>

                    <Style TargetType="DataGridRow">
                        <Setter Property="BorderThickness"
                                Value="0"/>
                        <Style.Triggers>
                            <Trigger Property="IsMouseOver"
                                     Value="True">
                                <Setter Property="Background"
                                        Value="{DynamicResource PrimaryHueLightBrush}"/>
                            </Trigger>
                            <Trigger Property="IsSelected"
                                     Value="True">
                                <Setter Property="Background"
                                        Value="{DynamicResource PrimaryHueMidBrush}"/>
                                <Setter Property="Foreground"
                                        Value="White"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>

                    <Style TargetType="DataGridCell">
                        <Setter Property="BorderThickness"
                                Value="0"/>
                        <Setter Property="Padding"
                                Value="12,8"/>
                    </Style>
                </DataGrid.Resources>

                <DataGrid.Columns>
                    <!-- Student Name -->
                    <DataGridTextColumn Header="ðŸ‘¤ Student Name"
                                        Binding="{Binding StudentName}"
                                        Width="2.5*">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="VerticalAlignment"
                                        Value="Center"/>
                                <Setter Property="FontWeight"
                                        Value="Medium"/>
                                <Setter Property="Margin"
                                        Value="18,0,0,0"/>
                                <!-- Left padding only -->
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>

                    <!-- Class -->
                    <DataGridTextColumn Header="ðŸ« Class"
                                        Binding="{Binding ClassName}"
                                        Width="1*">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="VerticalAlignment"
                                        Value="Center"/>
                                <Setter Property="HorizontalAlignment"
                                        Value="Center"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>

                    <!-- Guardians -->
                    <DataGridTextColumn Header="ðŸ‘ª Guardians"
                                        Binding="{Binding Guardians}"
                                        Width="3*">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="VerticalAlignment"
                                        Value="Center"/>
                                <Setter Property="TextWrapping"
                                        Value="Wrap"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>

                    <!-- Fingerprint ID -->
                    <DataGridTextColumn Header="ðŸ†” Fingerprint ID"
                                        Binding="{Binding FingerprintId}"
                                        Width="1*">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="VerticalAlignment"
                                        Value="Center"/>
                                <Setter Property="HorizontalAlignment"
                                        Value="Center"/>
                                <Setter Property="FontFamily"
                                        Value="Consolas"/>
                                <Setter Property="FontSize"
                                        Value="12"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>

                    <!-- Actions Column -->
                    <DataGridTemplateColumn Header="âš¡ Actions"
                                            Width="2.5*"
                                            IsReadOnly="True">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center">
                                    <!-- View Button -->
                                    <Button ToolTip="View student details"
                                            Style="{StaticResource SecondaryButtonStyle}"
                                            Click="View_Click">
                                        <StackPanel Orientation="Horizontal">
                                            <materialDesign:PackIcon Kind="Eye"
                                                                     Width="16"
                                                                     Height="16"
                                                                     Margin="0,0,4,0"/>
                                            <TextBlock Text="View"/>
                                        </StackPanel>
                                    </Button>

                                    <!-- Edit Button -->
                                    <Button ToolTip="Edit student information"
                                            Style="{StaticResource PrimaryButtonStyle}"
                                            Click="Edit_Click"
                                            Margin="8,0,0,0">
                                        <StackPanel Orientation="Horizontal">
                                            <materialDesign:PackIcon Kind="Pencil"
                                                                     Width="16"
                                                                     Height="16"
                                                                     Margin="0,0,4,0"/>
                                            <TextBlock Text="Edit"/>
                                        </StackPanel>
                                    </Button>

                                    <!-- Delete Button -->
                                    <Button ToolTip="Delete student record"
                                            Style="{StaticResource DangerButtonStyle}"
                                            Click="Delete_Click"
                                            Margin="8,0,0,0">
                                        <StackPanel Orientation="Horizontal">
                                            <materialDesign:PackIcon Kind="Delete"
                                                                     Width="16"
                                                                     Height="16"
                                                                     Margin="0,0,4,0"/>
                                            <TextBlock Text="Delete"/>
                                        </StackPanel>
                                    </Button>
                                </StackPanel>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
        </materialDesign:Card>

        <!-- Status Bar -->
        <Border Grid.Row="4"
                Background="{DynamicResource MaterialDesignCardBackground}"
                BorderBrush="{DynamicResource MaterialDesignDivider}"
                BorderThickness="0,1,0,0"
                Margin="0,16,0,0"
                Padding="16,10">
            <Grid>
                <TextBlock x:Name="StatusText"
                           Text="âœ… Ready - 0 students loaded"
                           VerticalAlignment="Center"
                           Foreground="{DynamicResource MaterialDesignBody}"/>

                <StackPanel Orientation="Horizontal"
                            HorizontalAlignment="Right">
                    <materialDesign:PackIcon Kind="AccountMultiple"
                                             Width="18"
                                             Height="18"
                                             Foreground="{DynamicResource PrimaryHueMidBrush}"
                                             Margin="0,0,8,0"
                                             VerticalAlignment="Center"/>
                    <TextBlock VerticalAlignment="Center"
                               Foreground="{DynamicResource PrimaryHueMidBrush}">
                        <Run Text="Total Students:"
                             FontWeight="SemiBold"/>
                        <Run x:Name="StudentCountText"
                             Text="0"/>
                    </TextBlock>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>